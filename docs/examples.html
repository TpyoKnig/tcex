

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Examples &mdash; TcEx 2.0.11 documentation</title>



  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />







  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->


      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>

    <script type="text/javascript" src="_static/js/theme.js"></script>


    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Logging" href="logging.html" />
    <link rel="prev" title="Exit" href="exit.html" />
</head>

<body class="wy-body-for-nav">


  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



            <a href="index.html" class="icon icon-home" alt="Documentation Home"> TcEx



          </a>




              <div class="version">
                2.0.11
              </div>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>


        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">






              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_apps_quickstart.html">Building Apps: Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_apps_tcinit.html">Building Apps: Templates (tcinit)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_apps_tclib.html">Building Apps: Dependencies (tclib)</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_apps_tcpackage.html">Building Apps: Packaging (tcpackage)</a></li>
<li class="toctree-l1"><a class="reference internal" href="app_deployment_configuration.html">App-Deployment Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="app_directory_structure.html">App-Directory Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_batch.html">Module: Batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_cache.html">Module: Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_case_management.html">Module: Case Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_datastore.html">Module: Datastore</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_decorators.html">Module: Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_metrics.html">Module: Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_notifications.html">Module: Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_playbook.html">Module: Playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_services.html">Module: Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_threat_intelligence.html">Module: Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_utils.html">Module: Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="authorization.html">Authorization (Token/HMAC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="exit.html">Exit</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#threat-intelligence">Threat Intelligence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-indicator-to-group-association-1">Create Indicator to Group Association 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-indicator-to-group-association-2">Create Indicator to Group Association 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#retrieve-indicator-to-group-associations">Retrieve Indicator to Group Associations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#retrieve-group-to-indicator-associations">Retrieve Group to Indicator Associations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-dns-whois-group">Enable DNS Whois Group</a></li>
<li class="toctree-l3"><a class="reference internal" href="#retrieve-inactive-indicators">Retrieve Inactive Indicators</a></li>
<li class="toctree-l3"><a class="reference internal" href="#retrieve-active-and-inactive-indicators">Retrieve Active and Inactive Indicators</a></li>
<li class="toctree-l3"><a class="reference internal" href="#retrieve-indicators-with-date-added-filters">Retrieve Indicators with Date Added filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#retrieve-indicators-owners">Retrieve Indicators Owners</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#snippets">Snippets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#feature">Feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batch">Batch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initialize-batch-create">Initialize Batch Create</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialize-batch-delete">Initialize Batch Delete</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-group-interface-1">Add Group Interface 1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-group-interface-2">Add Group Interface 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-attribute">Add Attribute</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-tag">Add Tag</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-security-label">Add Security Label</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-association">Add Association</a></li>
<li class="toctree-l4"><a class="reference internal" href="#save">Save</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-indicator-interface-1">Add Indicator Interface 1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-indicator-interface-2">Add Indicator Interface 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submit">Submit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#case-management">Case Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#create-case">Create Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-case">Update Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-case">Delete Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-case">Get Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-sub-artifacts">Get Sub Artifacts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-case-with-artifacts">Create Case with Artifacts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-cases-with-tql">Get Cases with TQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-cases-with-linked-tql">Get Cases with Linked TQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-artifact">Create Artifact</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-note">Create Note</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Add Tag</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-task">Create Task</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-workflow-event">Create Workflow Event</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#datastore">DataStore</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initialize-local">Initialize Local</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialize-organization">Initialize Organization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get">Get</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add">Add</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-dynamic-id">Add (dynamic id)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#put">Put</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete">Delete</a></li>
<li class="toctree-l4"><a class="reference internal" href="#search">Search</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exit">Exit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#set-exit-message">Set exit message</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-exit-code">Set exit code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exit-with-error">Exit with error</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#general">General</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#action-method">Action Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-variable-type">Get variable type</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#logging">Logging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#debug">Debug</a></li>
<li class="toctree-l4"><a class="reference internal" href="#info">Info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#warning">Warning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#error">Error</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#metrics">Metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#add-metrics">Add Metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-keyed-metrics">Add Keyed Metrics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#notifications">Notifications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#send-to-recipients">Send to Recipients</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sent-to-organization">Sent to Organization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Threat Intelligence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#get-group-by-id">Get Group by Id</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-groups">Get Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-tags">Get Tags</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-attributes">Get Attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-associations">Get Associations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-group">Create Group</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Add Tag</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Add Attribute</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Add Security Label</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">Add Association</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-group">Update Group</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-group">Delete Group</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-indicatory-by-value">Get Indicatory by Value</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-indicators">Get Indicators</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-indicator">Create Indicator</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="message_tc.html">Message TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="parser.html">Parser/Args</a></li>
<li class="toctree-l1"><a class="reference internal" href="proxies.html">Proxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="results_tc.html">Results TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tcex_docs/modules.html">TcEx Package</a></li>
</ul>



        </div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" aria-label="top navigation">

          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TcEx</a>

      </nav>


      <div class="wy-nav-content">

        <div class="rst-content">

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">

      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>

      <li>Examples</li>


      <li class="wy-breadcrumbs-aside">



      </li>

  </ul>


  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <div class="section" id="examples">
<span id="id1"></span><h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="threat-intelligence">
<h2>Threat Intelligence<a class="headerlink" href="#threat-intelligence" title="Permalink to this headline">¶</a></h2>
<div class="section" id="create-indicator-to-group-association-1">
<span id="examples-ti-associations"></span><h3>Create Indicator to Group Association 1<a class="headerlink" href="#create-indicator-to-group-association-1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Creating a Indicator and Group to insure that a association can be made.</span>
<span class="n">indicator_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="s1">&#39;1.1.1.1&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span>
<span class="n">group_kwargs</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;fileName&#39;</span><span class="p">:</span> <span class="s1">&#39;rand_filename&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;rand_name&#39;</span> <span class="p">}</span>
<span class="n">indicator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="s1">&#39;address&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="o">**</span><span class="n">indicator_kwargs</span><span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="o">**</span><span class="n">group_kwargs</span><span class="p">)</span>
<span class="c1"># Can be done this way as well:</span>
<span class="c1"># indicator = self.ti.address(self.owner, **indicator_kwargs)</span>
<span class="c1"># group = self.ti.document(self.owner, **group_kwargs)</span>
<span class="n">indicator</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="n">group</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

<span class="c1"># indicator to associate</span>
<span class="n">indicator</span><span class="o">.</span><span class="n">add_association</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="create-indicator-to-group-association-2">
<h3>Create Indicator to Group Association 2<a class="headerlink" href="#create-indicator-to-group-association-2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Creating a Indicator and Group to insure that a association can be made.</span>
<span class="n">indicator_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="s1">&#39;1.1.1.1&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span>
<span class="n">group_kwargs</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;fileName&#39;</span><span class="p">:</span> <span class="s1">&#39;rand_filename&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;rand_name&#39;</span> <span class="p">}</span>
<span class="n">indicator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="s1">&#39;address&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="o">**</span><span class="n">indicator_kwargs</span><span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="o">**</span><span class="n">group_kwargs</span><span class="p">)</span>
<span class="n">indicator</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="n">group</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

<span class="c1"># Create indicators/groups representing the indicators/groups in TC</span>
<span class="n">indicator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="s1">&#39;address&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="s1">&#39;1.1.1.1&#39;</span><span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;document&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">unique_id</span><span class="p">)</span>
<span class="c1"># Can be done this way as well:</span>
<span class="c1"># indicator = self.ti.address(self.owner, &#39;1.1.1.1&#39;)</span>
<span class="c1"># group = self.ti.document(self.owner, id=group.unique_id)</span>

<span class="c1"># indicator to associate</span>
<span class="n">indicator</span><span class="o">.</span><span class="n">add_association</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="retrieve-indicator-to-group-associations">
<h3>Retrieve Indicator to Group Associations<a class="headerlink" href="#retrieve-indicator-to-group-associations" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Creating a Indicator to make sure group associations can be retrieved.</span>
<span class="n">indicator_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="s1">&#39;1.1.1.1&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span>
<span class="n">indicator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">address</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="s1">&#39;1.1.1.1&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">indicator</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

<span class="k">for</span> <span class="n">association</span> <span class="ow">in</span> <span class="n">indicator</span><span class="o">.</span><span class="n">group_associations</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">association</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="retrieve-group-to-indicator-associations">
<h3>Retrieve Group to Indicator Associations<a class="headerlink" href="#retrieve-group-to-indicator-associations" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Creating a Indicator to make sure group associations can be retrieved.</span>
<span class="n">group_kwargs</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;fileName&#39;</span><span class="p">:</span> <span class="s1">&#39;rand_filename&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;rand_name&#39;</span> <span class="p">}</span>
<span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">document</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="o">**</span><span class="n">group_kwargs</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

<span class="k">for</span> <span class="n">association</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">indicator_associations</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">association</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="enable-dns-whois-group">
<h3>Enable DNS Whois Group<a class="headerlink" href="#enable-dns-whois-group" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="n">group_type</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="n">group_id</span><span class="p">)</span>
<span class="c1"># get indicator associations</span>
<span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">indicator_associations</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">indicator</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Host&#39;</span><span class="p">:</span>
        <span class="n">ti_host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">host</span><span class="p">(</span>
            <span class="n">hostName</span><span class="o">=</span><span class="n">indicator</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;summary&#39;</span><span class="p">),</span>
            <span class="n">owner</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span>
            <span class="n">dns_active</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">whois_active</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">ti_host</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">ti_host_data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">,</span> <span class="p">{})</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="retrieve-inactive-indicators">
<span id="examples-ti-status"></span><h3>Retrieve Inactive Indicators<a class="headerlink" href="#retrieve-inactive-indicators" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">address</span><span class="p">()</span>
<span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">filters</span><span class="p">()</span>
<span class="n">filters</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">many</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="retrieve-active-and-inactive-indicators">
<h3>Retrieve Active and Inactive Indicators<a class="headerlink" href="#retrieve-active-and-inactive-indicators" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">address</span><span class="p">()</span>
<span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">filters</span><span class="p">()</span>
<span class="n">filters</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">)</span>
<span class="n">filters</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">)</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;orParams&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">}</span>
<span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">many</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="retrieve-indicators-with-date-added-filters">
<h3>Retrieve Indicators with Date Added filters<a class="headerlink" href="#retrieve-indicators-with-date-added-filters" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">filters</span><span class="p">()</span>
<span class="n">filters</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s1">&#39;dateAdded&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-01-01&#39;</span><span class="p">)</span>
<span class="n">filters</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s1">&#39;dateAdded&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-01-02&#39;</span><span class="p">)</span>
<span class="n">indicators</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="s1">&#39;example&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">indicators</span><span class="o">.</span><span class="n">many</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">indicator</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="retrieve-indicators-owners">
<h3>Retrieve Indicators Owners<a class="headerlink" href="#retrieve-indicators-owners" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Create a example indicator</span>
<span class="n">indicator_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="s1">&#39;1.1.1.1&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)}</span>
<span class="n">indicator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="s1">&#39;address&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">,</span> <span class="o">**</span><span class="n">indicator_kwargs</span><span class="p">)</span>
<span class="n">indicator</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
<span class="c1"># Get the owners that indicator is in.</span>
<span class="n">owner</span> <span class="o">=</span> <span class="n">indicator</span><span class="o">.</span><span class="n">owners</span><span class="p">()</span>
<span class="c1"># indicator.owners() return the response, time to get the owner data.</span>
<span class="n">owner_data</span> <span class="o">=</span> <span class="n">owner</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;owner&#39;</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="snippets">
<h2>Snippets<a class="headerlink" href="#snippets" title="Permalink to this headline">¶</a></h2>
<div class="section" id="feature">
<span id="id2"></span><h3>Feature<a class="headerlink" href="#feature" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="batch">
<h3>Batch<a class="headerlink" href="#batch" title="Permalink to this headline">¶</a></h3>
<div class="section" id="initialize-batch-create">
<h4>Initialize Batch Create<a class="headerlink" href="#initialize-batch-create" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="s2">&quot;MyOwner&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="initialize-batch-delete">
<h4>Initialize Batch Delete<a class="headerlink" href="#initialize-batch-delete" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="s2">&quot;MyOwner&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;Delete&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add-group-interface-1">
<h4>Add Group Interface 1<a class="headerlink" href="#add-group-interface-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">campaign</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;camp-1&quot;</span><span class="p">,</span> <span class="n">first_seen</span><span class="o">=</span><span class="s2">&quot;12-12-08&quot;</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="s2">&quot;my-unique-external-id&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add-group-interface-2">
<h4>Add Group Interface 2<a class="headerlink" href="#add-group-interface-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s2">&quot;Campaign&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;camp-2&quot;</span><span class="p">,</span> <span class="n">date_added</span><span class="o">=</span><span class="s2">&quot;12-12-2008&quot;</span><span class="p">,</span> <span class="n">first_seen</span><span class="o">=</span><span class="s2">&quot;12-12-08&quot;</span><span class="p">,</span> <span class="n">xid</span><span class="o">=</span><span class="s2">&quot;my-unique-external-id&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add-attribute">
<h4>Add Attribute<a class="headerlink" href="#add-attribute" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span><span class="n">attr_type</span><span class="o">=</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="n">attr_value</span><span class="o">=</span><span class="s2">&quot;Example Description&quot;</span><span class="p">,</span> <span class="n">displayed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add-tag">
<h4>Add Tag<a class="headerlink" href="#add-tag" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Crimeware&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add-security-label">
<h4>Add Security Label<a class="headerlink" href="#add-security-label" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">security_label</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;My Custom Label&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;My Label Description&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;ffffff&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add-association">
<h4>Add Association<a class="headerlink" href="#add-association" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">association</span><span class="p">(</span><span class="s2">&quot;my-unique-adversary-external-id&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="save">
<h4>Save<a class="headerlink" href="#save" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># temporarily save group to disk to preserve memory</span>
<span class="n">batch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add-indicator-interface-1">
<h4>Add Indicator Interface 1<a class="headerlink" href="#add-indicator-interface-1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="n">md5</span><span class="o">=</span><span class="s2">&quot;43c3609411c83f363e051d455ade78a6&quot;</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="s2">&quot;5.0&quot;</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="s2">&quot;100&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add-indicator-interface-2">
<h4>Add Indicator Interface 2<a class="headerlink" href="#add-indicator-interface-2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">indicator_type</span><span class="o">=</span><span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="s2">&quot;43c3609411c83f363e051d455ade78a6&quot;</span><span class="p">)</span>
<span class="n">ti</span><span class="o">.</span><span class="n">confidence</span> <span class="o">=</span> <span class="s2">&quot;50&quot;</span>
<span class="n">ti</span><span class="o">.</span><span class="n">rating</span> <span class="o">=</span> <span class="s2">&quot;3.2&quot;</span>
<span class="n">ti</span><span class="o">.</span><span class="n">occurrence</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;drop1.exe&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\\\</span><span class="s2">test</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="s2">&quot;2017-02-02&quot;</span><span class="p">)</span>
<span class="n">ti</span><span class="o">.</span><span class="n">occurrence</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;drop2.exe&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\\\</span><span class="s2">test2</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="s2">&quot;2017-01-01&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="submit">
<h4>Submit<a class="headerlink" href="#submit" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">batch_status</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">submit_all</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="case-management">
<h3>Case Management<a class="headerlink" href="#case-management" title="Permalink to this headline">¶</a></h3>
<div class="section" id="create-case">
<h4>Create Case<a class="headerlink" href="#create-case" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">case_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Case Name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Open&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="o">**</span><span class="n">case_data</span><span class="p">)</span>
<span class="n">case</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="update-case">
<h4>Update Case<a class="headerlink" href="#update-case" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">case</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Updated Name&quot;</span>
<span class="n">case</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="delete-case">
<h4>Delete Case<a class="headerlink" href="#delete-case" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">case</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-case">
<h4>Get Case<a class="headerlink" href="#get-case" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">case</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-sub-artifacts">
<h4>Get Sub Artifacts<a class="headerlink" href="#get-sub-artifacts" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">case</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">all_available_fields</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">artifact</span> <span class="ow">in</span> <span class="n">case</span><span class="o">.</span><span class="n">artifacts</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;artifact: </span><span class="si">{</span><span class="n">artifact</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="create-case-with-artifacts">
<h4>Create Case with Artifacts<a class="headerlink" href="#create-case-with-artifacts" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">case_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Case Name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Open&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="o">**</span><span class="n">case_data</span><span class="p">)</span>

<span class="c1"># artifact data</span>
<span class="n">artifact_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;asn4455&quot;</span><span class="p">,</span> <span class="s2">&quot;intel_type&quot;</span><span class="p">:</span> <span class="s2">&quot;indicator-ASN&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ASN&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;asn5544&quot;</span><span class="p">,</span> <span class="s2">&quot;intel_type&quot;</span><span class="p">:</span> <span class="s2">&quot;indicator-ASN&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ASN&quot;</span><span class="p">},</span>
<span class="p">]</span>

<span class="c1"># add artifacts</span>
<span class="k">for</span> <span class="n">artifact</span> <span class="ow">in</span> <span class="n">artifact_data</span><span class="p">:</span>
    <span class="n">case</span><span class="o">.</span><span class="n">add_artifact</span><span class="p">(</span><span class="o">**</span><span class="n">artifact</span><span class="p">)</span>
<span class="n">case</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-cases-with-tql">
<h4>Get Cases with TQL<a class="headerlink" href="#get-cases-with-tql" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">cases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">cases</span><span class="p">()</span>
<span class="n">cases</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">TQL</span><span class="o">.</span><span class="n">Operator</span><span class="o">.</span><span class="n">EQ</span><span class="p">,</span> <span class="n">case</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

<span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">cases</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;case: </span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-cases-with-linked-tql">
<h4>Get Cases with Linked TQL<a class="headerlink" href="#get-cases-with-linked-tql" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">cases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">cases</span><span class="p">()</span>
<span class="n">cases</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">has_artifact</span><span class="o">.</span><span class="n">id</span><span class="p">(</span><span class="n">TQL</span><span class="o">.</span><span class="n">Operator</span><span class="o">.</span><span class="n">EQ</span><span class="p">,</span> <span class="n">artifact</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

<span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">cases</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;case: </span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="create-artifact">
<h4>Create Artifact<a class="headerlink" href="#create-artifact" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">artifact_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;case_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;asn2342&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ASN&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># create artifact</span>
<span class="n">artifact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">artifact</span><span class="p">(</span><span class="o">**</span><span class="n">artifact_data</span><span class="p">)</span>
<span class="n">artifact</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="create-note">
<h4>Create Note<a class="headerlink" href="#create-note" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">note_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;case_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;sample note for test case.&quot;</span>
<span class="p">}</span>

<span class="c1"># create note</span>
<span class="n">note</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">note</span><span class="p">(</span><span class="o">**</span><span class="n">note_data</span><span class="p">)</span>
<span class="n">note</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id3">
<h4>Add Tag<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">case</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">case</span><span class="o">.</span><span class="n">add_tag</span><span class="p">(</span><span class="s2">&quot;sample tag&quot;</span><span class="p">)</span>
<span class="n">case</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="create-task">
<h4>Create Task<a class="headerlink" href="#create-task" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">task_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;case_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;a description for new task&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;new task&quot;</span><span class="p">,</span>
    <span class="s2">&quot;xid&quot;</span><span class="p">:</span> <span class="s2">&quot;unique-task-xid&quot;</span>
<span class="p">}</span>

<span class="c1"># create task</span>
<span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="o">**</span><span class="n">task_data</span><span class="p">)</span>
<span class="n">task</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="create-workflow-event">
<h4>Create Workflow Event<a class="headerlink" href="#create-workflow-event" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">workflow_event_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;case_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;workflow event summary&quot;</span>
<span class="p">}</span>

<span class="c1"># create workflow_event</span>
<span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">workflow_event</span><span class="p">(</span><span class="o">**</span><span class="n">workflow_event_data</span><span class="p">)</span>
<span class="n">workflow_event</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="datastore">
<h3>DataStore<a class="headerlink" href="#datastore" title="Permalink to this headline">¶</a></h3>
<div class="section" id="initialize-local">
<h4>Initialize Local<a class="headerlink" href="#initialize-local" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># when using a value of &quot;local&quot; the scope of the datastore is limited to this App in the current Playbook</span>
<span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">datastore</span><span class="p">(</span><span class="s2">&quot;local&quot;</span><span class="p">,</span> <span class="s2">&quot;myDnsData&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="initialize-organization">
<h4>Initialize Organization<a class="headerlink" href="#initialize-organization" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">datastore</span><span class="p">(</span><span class="s2">&quot;organization&quot;</span><span class="p">,</span> <span class="s2">&quot;myDnsData&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get">
<h4>Get<a class="headerlink" href="#get" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rid</span><span class="o">=</span><span class="s2">&quot;one&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add">
<h4>Add<a class="headerlink" href="#add" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rid</span><span class="o">=</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;one&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add-dynamic-id">
<h4>Add (dynamic id)<a class="headerlink" href="#add-dynamic-id" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;one&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="put">
<h4>Put<a class="headerlink" href="#put" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">rid</span><span class="o">=</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;one&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="delete">
<h4>Delete<a class="headerlink" href="#delete" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">rid</span><span class="o">=</span><span class="s2">&quot;one&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="search">
<h4>Search<a class="headerlink" href="#search" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">search</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;match_all&quot;</span><span class="p">:</span> <span class="p">{}}}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rid</span><span class="o">=</span><span class="s2">&quot;_search&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">search</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="exit">
<h3>Exit<a class="headerlink" href="#exit" title="Permalink to this headline">¶</a></h3>
<div class="section" id="set-exit-message">
<h4>Set exit message<a class="headerlink" href="#set-exit-message" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">exit_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Created </span><span class="si">{</span><span class="n">indicator_count</span><span class="si">}</span><span class="s2"> indicators.&quot;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="set-exit-code">
<h4>Set exit code<a class="headerlink" href="#set-exit-code" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># set the exit code and allow App to continue to process</span>
<span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">playbook</span><span class="o">.</span><span class="n">exit_code</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="exit-with-error">
<h4>Exit with error<a class="headerlink" href="#exit-with-error" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># exit the App immediately with the provided exit message</span>
<span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">playbook</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Failed to add indicators to Owner.&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="general">
<h3>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h3>
<div class="section" id="action-method">
<h4>Action Method<a class="headerlink" href="#action-method" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nd">@IterateOnArg</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="s2">&quot;input_arg&quot;</span><span class="p">)</span>
<span class="nd">@OnException</span><span class="p">(</span><span class="n">exit_msg</span><span class="o">=</span><span class="s2">&quot;Failed to run &quot;</span><span class="n">do</span> <span class="n">something</span><span class="s2">&quot; operation.&quot;</span><span class="p">)</span>
<span class="nd">@OnSuccess</span><span class="p">(</span><span class="n">exit_msg</span><span class="o">=</span><span class="s2">&quot;Successfully ran &quot;</span><span class="n">do</span> <span class="n">something</span><span class="s2">&quot; operation.&quot;</span><span class="p">)</span>
<span class="nd">@Output</span><span class="p">(</span><span class="n">attribute</span><span class="o">=</span><span class="s2">&quot;return_outputs&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_arg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform an action on interator_input and append return value to self.return_outputs.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">input_arg</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-variable-type">
<h4>Get variable type<a class="headerlink" href="#get-variable-type" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">var_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">playbook</span><span class="o">.</span><span class="n">variable_type</span><span class="p">(</span><span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="logging">
<h3>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<div class="section" id="debug">
<h4>Debug<a class="headerlink" href="#debug" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;debug logging&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="info">
<h4>Info<a class="headerlink" href="#info" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;info logging&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="warning">
<h4>Warning<a class="headerlink" href="#warning" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;warning logging&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="error">
<h4>Error<a class="headerlink" href="#error" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;error logging&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="metrics">
<h3>Metrics<a class="headerlink" href="#metrics" title="Permalink to this headline">¶</a></h3>
<div class="section" id="add-metrics">
<h4>Add Metrics<a class="headerlink" href="#add-metrics" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;My Metric&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Indicator Count&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;Sum&quot;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="s2">&quot;Daily&quot;</span><span class="p">,</span> <span class="n">keyed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">metrics</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="s2">&quot;2008-12-12T12:12:12&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="add-keyed-metrics">
<h4>Add Keyed Metrics<a class="headerlink" href="#add-keyed-metrics" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;My Metric By Owner&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Indicator Count by Owner&quot;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;Sum&quot;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="s2">&quot;Daily&quot;</span><span class="p">,</span> <span class="n">keyed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">metrics</span><span class="o">.</span><span class="n">add_keyed</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;MyOrg&quot;</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="s2">&quot;2008-12-12T12:12:12&quot;</span><span class="p">,</span> <span class="n">return_value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="notifications">
<h3>Notifications<a class="headerlink" href="#notifications" title="Permalink to this headline">¶</a></h3>
<div class="section" id="send-to-recipients">
<h4>Send to Recipients<a class="headerlink" href="#send-to-recipients" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">notification</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">notification</span><span class="p">()</span>
<span class="n">notification</span><span class="o">.</span><span class="n">recipients</span><span class="p">(</span><span class="n">notification_type</span><span class="o">=</span><span class="s2">&quot;My notification&quot;</span><span class="p">,</span> <span class="n">recipients</span><span class="o">=</span><span class="s2">&quot;myuser@example.com&quot;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="s2">&quot;High&quot;</span><span class="p">)</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">notification</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;High alert send to recipients.&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sent-to-organization">
<h4>Sent to Organization<a class="headerlink" href="#sent-to-organization" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">notification</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">notification</span><span class="p">()</span>
<span class="n">notification</span><span class="o">.</span><span class="n">org</span><span class="p">(</span><span class="n">notification_type</span><span class="o">=</span><span class="s2">&quot;My notification&quot;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="s2">&quot;High&quot;</span><span class="p">)</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">notification</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;High alert send to organization.&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="id4">
<h3>Threat Intelligence<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="section" id="get-group-by-id">
<h4>Get Group by Id<a class="headerlink" href="#get-group-by-id" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;additional&quot;</span><span class="p">,</span> <span class="s2">&quot;attributes&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s2">&quot;Adversary&quot;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s2">&quot;MyOrg&quot;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="mi">416</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">single</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-groups">
<h4>Get Groups<a class="headerlink" href="#get-groups" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;additional&quot;</span><span class="p">,</span> <span class="s2">&quot;attributes&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s2">&quot;Adversary&quot;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s2">&quot;MyOrg&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="o">.</span><span class="n">many</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;group: </span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-tags">
<h4>Get Tags<a class="headerlink" href="#get-tags" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">tags</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tag: </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-attributes">
<h4>Get Attributes<a class="headerlink" href="#get-attributes" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">attributes</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;attribute: </span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-associations">
<h4>Get Associations<a class="headerlink" href="#get-associations" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">association</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">indicator_associations</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;association: </span><span class="si">{</span><span class="n">association</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="create-group">
<h4>Create Group<a class="headerlink" href="#create-group" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s2">&quot;Campaign&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;camp-3&quot;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s2">&quot;MyOrg&quot;</span><span class="p">,</span> <span class="n">first_seen</span><span class="o">=</span><span class="s2">&quot;2019-04-02&quot;</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id5">
<h4>Add Tag<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Crimeware&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id6">
<h4>Add Attribute<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">attribute_type</span><span class="o">=</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="n">attribute_value</span><span class="o">=</span><span class="s2">&quot;Example Description.&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id7">
<h4>Add Security Label<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;TLP:GREEN&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id8">
<h4>Add Association<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">group_assoc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s2">&quot;Campaign&quot;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="mi">417</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">add_association</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">group_assoc</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="update-group">
<h4>Update Group<a class="headerlink" href="#update-group" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s2">&quot;Campaign&quot;</span><span class="p">,</span> <span class="n">first_seen</span><span class="o">=</span><span class="s2">&quot;2019-04-03&quot;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="mi">417</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="delete-group">
<h4>Delete Group<a class="headerlink" href="#delete-group" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">group_type</span><span class="o">=</span><span class="s2">&quot;Campaign&quot;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="mi">419</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-indicatory-by-value">
<h4>Get Indicatory by Value<a class="headerlink" href="#get-indicatory-by-value" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;additional&quot;</span><span class="p">,</span> <span class="s2">&quot;attributes&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">indicator_type</span><span class="o">=</span><span class="s2">&quot;Address&quot;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s2">&quot;MyOrg&quot;</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">single</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-indicators">
<h4>Get Indicators<a class="headerlink" href="#get-indicators" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;additional&quot;</span><span class="p">,</span> <span class="s2">&quot;attributes&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">indicators</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">indicator_type</span><span class="o">=</span><span class="s2">&quot;Address&quot;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s2">&quot;MyOrg&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">indicators</span><span class="o">.</span><span class="n">many</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;indicator: </span><span class="si">{</span><span class="n">indicator</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="create-indicator">
<h4>Create Indicator<a class="headerlink" href="#create-indicator" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">ti</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">indicator_type</span><span class="o">=</span><span class="s2">&quot;Address&quot;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s2">&quot;MyOrg&quot;</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="s2">&quot;12.13.14.15&quot;</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>
</div>


           </div>

          </div>
          <footer>

    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">

        <a href="logging.html" class="btn btn-neutral float-right" title="Logging" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>


        <a href="exit.html" class="btn btn-neutral float-left" title="Exit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>

    </div>


  <hr/>

  <div role="contentinfo">
    <p>

        &copy; Copyright 2016, ThreatConnect Inc

    </p>
  </div>

</footer>

        </div>
      </div>

    </section>

  </div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>






</body>
</html>
