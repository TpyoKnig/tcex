

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>tcex.threat_intelligence.tcex_ti_tc_request &mdash; TcEx 2.0.11 documentation</title>



  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />







  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->


      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>

    <script type="text/javascript" src="../../../_static/js/theme.js"></script>


    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
</head>

<body class="wy-body-for-nav">


  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> TcEx



          </a>




              <div class="version">
                2.0.11
              </div>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>


        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">






              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../building_apps_quickstart.html">Building Apps: Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../building_apps_tcinit.html">Building Apps: Templates (tcinit)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../building_apps_tclib.html">Building Apps: Dependencies (tclib)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../building_apps_tcpackage.html">Building Apps: Packaging (tcpackage)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../app_deployment_configuration.html">App-Deployment Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../app_directory_structure.html">App-Directory Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_batch.html">Module: Batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_cache.html">Module: Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_case_management.html">Module: Case Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_datastore.html">Module: Datastore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_decorators.html">Module: Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_metrics.html">Module: Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_notifications.html">Module: Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_playbook.html">Module: Playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_services.html">Module: Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_threat_intelligence.html">Module: Threat Intelligence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_utils.html">Module: Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authorization.html">Authorization (Token/HMAC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../exit.html">Exit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../message_tc.html">Message TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parser.html">Parser/Args</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../proxies.html">Proxies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../results_tc.html">Results TC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tcex_docs/modules.html">TcEx Package</a></li>
</ul>



        </div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" aria-label="top navigation">

          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">TcEx</a>

      </nav>


      <div class="wy-nav-content">

        <div class="rst-content">

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">

      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>

          <li><a href="../../index.html">Module code</a> &raquo;</li>

      <li>tcex.threat_intelligence.tcex_ti_tc_request</li>


      <li class="wy-breadcrumbs-aside">

      </li>

  </ul>


  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <h1>Source code for tcex.threat_intelligence.tcex_ti_tc_request</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;ThreatConnect Threat Intelligence Module&quot;&quot;&quot;</span>
<span class="c1"># standard library</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">quote</span>

<span class="c1"># import local modules for dynamic reference</span>
<span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="TiTcRequest"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest">[docs]</a><span class="k">class</span> <span class="nc">TiTcRequest</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Common API calls to ThreatConnect</span>

<span class="sd">    Args:</span>
<span class="sd">        tcex ([type]): [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tcex</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Class properties.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span> <span class="o">=</span> <span class="n">tcex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result_limit</span> <span class="o">=</span> <span class="mi">10000</span>

<div class="viewcode-block" id="TiTcRequest._delete"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest._delete">[docs]</a>    <span class="k">def</span> <span class="nf">_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete data from API.&quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;false&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;Method: (</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">), &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;Params: (</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s1">), &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;Status Code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">, &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;URL: (</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;response: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="n">r</span><span class="o">.</span><span class="n">reason</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error deleting data (</span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest._get"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest._get">[docs]</a>    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete data from API.&quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;false&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;Method: (</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">), &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;Params: (</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s1">), &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;Status Code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">, &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;URL: (</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;response: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="n">r</span><span class="o">.</span><span class="n">reason</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error getting data (</span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest._iterate"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest._iterate">[docs]</a>    <span class="k">def</span> <span class="nf">_iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">api_entity</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Iterate over API pagination.&quot;&quot;&quot;</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;resultLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_limit</span>

        <span class="n">should_iterate</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">result_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">should_iterate</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;resultStart&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_start</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="n">r</span><span class="o">.</span><span class="n">reason</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">950</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="p">])</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">if</span> <span class="n">api_entity</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">api_entity</span><span class="p">,</span> <span class="p">[])</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_limit</span><span class="p">:</span>
                <span class="n">should_iterate</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">result_start</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_limit</span>

            <span class="k">yield from</span> <span class="n">data</span></div>

<div class="viewcode-block" id="TiTcRequest._post"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest._post">[docs]</a>    <span class="k">def</span> <span class="nf">_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Post data to API.&quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;false&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;Method: (</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">), &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;Params: (</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s1">), &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;Status Code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">, &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;URL: (</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;body: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;response: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="n">r</span><span class="o">.</span><span class="n">reason</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error posting data (</span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest._post_json"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest._post_json">[docs]</a>    <span class="k">def</span> <span class="nf">_post_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">json_data</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Post JSON data to API.&quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;false&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">json_data</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;Method: (</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">), &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;Params: (</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s1">), &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;Status Code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">, &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;URL: (</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;body: </span><span class="si">{</span><span class="n">json_data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;response: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="n">r</span><span class="o">.</span><span class="n">reason</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error posting data (</span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest._put_json"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest._put_json">[docs]</a>    <span class="k">def</span> <span class="nf">_put_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">json_data</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Post JSON data to API.&quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;false&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">json_data</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;Method: (</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">), &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;Params: (</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s1">), &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;Status Code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">, &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;URL: (</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;body: </span><span class="si">{</span><span class="n">json_data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;response: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="n">r</span><span class="o">.</span><span class="n">reason</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error updating data (</span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest.add_adversary_handle_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_adversary_handle_asset">[docs]</a>    <span class="k">def</span> <span class="nf">add_adversary_handle_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an asset to an Adversary.</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary</span>
<span class="sd">            value (str): The asset value</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/groups/adversaries/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/adversaryAssets/handles&#39;</span>
        <span class="n">asset_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;handle&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_json</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">asset_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.add_adversary_phone_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_adversary_phone_asset">[docs]</a>    <span class="k">def</span> <span class="nf">add_adversary_phone_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an asset to an Adversary.</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary</span>
<span class="sd">            value (str): The asset value</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/groups/adversaries/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/adversaryAssets/phoneNumbers&#39;</span>
        <span class="n">asset_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;phoneNumber&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_json</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">asset_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.add_adversary_url_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_adversary_url_asset">[docs]</a>    <span class="k">def</span> <span class="nf">add_adversary_url_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an asset to an Adversary.</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary</span>
<span class="sd">            value (str): The asset value</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/groups/adversaries/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/adversaryAssets/urls&#39;</span>
        <span class="n">asset_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_json</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">asset_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.adversary_assets"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.adversary_assets">[docs]</a>    <span class="k">def</span> <span class="nf">adversary_assets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all Adversary assets</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary</span>
<span class="sd">            params (dict, optional): The query params for the request. Defaults to None.</span>

<span class="sd">        Yields:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/groups/adversaries/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/adversaryAssets&#39;</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;bucketAsset&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.adversary_handle_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.adversary_handle_asset">[docs]</a>    <span class="k">def</span> <span class="nf">adversary_handle_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Adversary handle asset by ID</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary</span>
<span class="sd">            asset_id: (str) The ID of the asset.</span>
<span class="sd">            action: (str): The HTTP method (e.g., DELETE or GET)</span>
<span class="sd">            params (dict, optional): The query params for the request. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/groups/adversaries/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/adversaryAssets/handles/</span><span class="si">{</span><span class="n">asset_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="c1"># handle DELETE action</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.adversary_handle_assets"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.adversary_handle_assets">[docs]</a>    <span class="k">def</span> <span class="nf">adversary_handle_assets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all Adversary handle assets</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary</span>
<span class="sd">            params (dict, optional): The query params for the request. Defaults to None.</span>

<span class="sd">        Yields:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/groups/adversaries/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/adversaryAssets/handles&#39;</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;adversaryHandle&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.adversary_phone_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.adversary_phone_asset">[docs]</a>    <span class="k">def</span> <span class="nf">adversary_phone_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Adversary phone number asset by ID</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary</span>
<span class="sd">            asset_id: (str) The ID of the asset.</span>
<span class="sd">            action: (str): The HTTP method (e.g., DELETE or GET)</span>
<span class="sd">            params (dict, optional): The query params for the request. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/groups/adversaries/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/adversaryAssets/phoneNumbers/</span><span class="si">{</span><span class="n">asset_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="c1"># handle DELETE action</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.adversary_phone_assets"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.adversary_phone_assets">[docs]</a>    <span class="k">def</span> <span class="nf">adversary_phone_assets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all Adversary phone assets</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary</span>
<span class="sd">            params (dict, optional): The query params for the request. Defaults to None.</span>

<span class="sd">        Yields:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/groups/adversaries/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/adversaryAssets/phoneNumbers&#39;</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;adversaryPhoneNumber&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.adversary_url_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.adversary_url_asset">[docs]</a>    <span class="k">def</span> <span class="nf">adversary_url_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return Adversary url asset by ID</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary</span>
<span class="sd">            asset_id: (str) The ID of the asset.</span>
<span class="sd">            action: (str): The HTTP method (e.g., DELETE or GET)</span>
<span class="sd">            params (dict, optional): The query params for the request. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/groups/adversaries/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/adversaryAssets/urls/</span><span class="si">{</span><span class="n">asset_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="c1"># handle DELETE action</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.adversary_url_assets"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.adversary_url_assets">[docs]</a>    <span class="k">def</span> <span class="nf">adversary_url_assets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return all Adversary url assets</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary</span>
<span class="sd">            params (dict, optional): The query params for the request. Defaults to None.</span>

<span class="sd">        Yields:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/groups/adversaries/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/adversaryAssets/urls&#39;</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;adversaryUrl&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.create"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.create">[docs]</a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">owner</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a TI object in the API.</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type (str): The TI type (e.g., groups or indicators).</span>
<span class="sd">            sub_type (str): The TI sub type (e.g., adversaries or addresses).</span>
<span class="sd">            data (dict): The body for the POST.</span>
<span class="sd">            owner (str): The name of the TC owner.</span>

<span class="sd">        Returns:</span>
<span class="sd">            request.Response: The response from the API call.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a TI object in the API.</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type (str): The TI type (e.g., groups or indicators).</span>
<span class="sd">            sub_type (str): The TI sub type (e.g., adversaries or addresses).</span>
<span class="sd">            data (dict): The body for the POST.</span>
<span class="sd">            owner (str): The name of the TC owner.</span>

<span class="sd">        Returns:</span>
<span class="sd">            request.Response: The response from the API call.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">unique_id</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_adversary_handle_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_adversary_handle_asset">[docs]</a>    <span class="k">def</span> <span class="nf">delete_adversary_handle_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete Adversary handle assest</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary.</span>
<span class="sd">            asset_id: (str) The ID of the asset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adversary_handle_asset</span><span class="p">(</span><span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_adversary_phone_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_adversary_phone_asset">[docs]</a>    <span class="k">def</span> <span class="nf">delete_adversary_phone_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete Adversary phone assest</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary.</span>
<span class="sd">            asset_id: (str) The ID of the asset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adversary_phone_asset</span><span class="p">(</span><span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_adversary_url_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_adversary_url_asset">[docs]</a>    <span class="k">def</span> <span class="nf">delete_adversary_url_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete Adversary URL assest</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary.</span>
<span class="sd">            asset_id: (str) The ID of the asset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adversary_url_asset</span><span class="p">(</span><span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.download"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.download">[docs]</a>    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Download a Document or Report</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type (str): The TI type (e.g., groups or indicators).</span>
<span class="sd">            sub_type (str): The TI sub type (e.g., adversaries or addresses).</span>
<span class="sd">            unique_id (str): The unique ID of the Resource.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/download&#39;</span>
        <span class="k">if</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/download&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.get_adversary_handle_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_adversary_handle_asset">[docs]</a>    <span class="k">def</span> <span class="nf">get_adversary_handle_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Adversary handle assest</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary.</span>
<span class="sd">            asset_id: (str) The ID of the asset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adversary_handle_asset</span><span class="p">(</span><span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.get_adversary_phone_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_adversary_phone_asset">[docs]</a>    <span class="k">def</span> <span class="nf">get_adversary_phone_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Adversary phone assest</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary.</span>
<span class="sd">            asset_id: (str) The ID of the asset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adversary_phone_asset</span><span class="p">(</span><span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.get_adversary_url_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_adversary_url_asset">[docs]</a>    <span class="k">def</span> <span class="nf">get_adversary_url_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Adversary URL assest</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique ID of the Adversary.</span>
<span class="sd">            asset_id: (str) The ID of the asset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            requests.Response: A request Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">adversary_url_asset</span><span class="p">(</span><span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.many"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.many">[docs]</a>    <span class="k">def</span> <span class="nf">many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">api_entity</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update a TI object in the API.</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type (str): The TI type (e.g., groups or indicators).</span>
<span class="sd">            sub_type (str): The TI sub type (e.g., adversaries or addresses).</span>
<span class="sd">            api_entity (str): The API entity value (e.g., address, file, etc).</span>
<span class="sd">            owner (str): The name of the TC owner.</span>
<span class="sd">            filters (Filter, optional): A filter object.</span>
<span class="sd">            params (dict, optional): Optional dict of query params.</span>

<span class="sd">        Yields:</span>
<span class="sd">            request.Response: The response from the API call.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="c1"># add owner</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="c1"># add filters</span>
        <span class="k">if</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;filters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters_string</span>

        <span class="c1"># build url</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">api_entity</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.mine"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.mine">[docs]</a>    <span class="k">def</span> <span class="nf">mine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get owner mine data.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s1">&#39;/v2/owners/mine&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.request"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.request">[docs]</a>    <span class="k">def</span> <span class="nf">request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">result_limit</span><span class="p">,</span> <span class="n">result_start</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type ([type]): [description]</span>
<span class="sd">            sub_type ([type]): [description]</span>
<span class="sd">            result_limit ([type]): [description]</span>
<span class="sd">            result_start ([type]): [description]</span>
<span class="sd">            owner ([type], optional): [description]. Defaults to None.</span>
<span class="sd">            filters ([type], optional): [description]. Defaults to None.</span>
<span class="sd">            params ([type], optional): [description]. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            [type]: [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="c1"># add owner</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="c1"># add filters</span>
        <span class="k">if</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;filters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters_string</span>

        <span class="c1"># add result limits and result start</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;resultLimit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_limit</span> <span class="ow">or</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result_limit&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_limit</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;resultStart&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_start</span> <span class="ow">or</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result_start&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.single"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.single">[docs]</a>    <span class="k">def</span> <span class="nf">single</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update a TI object in the API.</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type (str): The TI type (e.g., groups or indicators).</span>
<span class="sd">            sub_type (str): The TI sub type (e.g., adversaries or addresses).</span>
<span class="sd">            unique_id (str): The unique ID of the TI object.</span>
<span class="sd">            owner (str): The name of the TC owner.</span>
<span class="sd">            filters (Filter, optional): A filter object.</span>
<span class="sd">            params (dict, optional): Optional dict of query params.</span>

<span class="sd">        Returns:</span>
<span class="sd">            request.Response: The response from the API call.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="c1"># add owner</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="c1"># add filters</span>
        <span class="k">if</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;filters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters_string</span>

        <span class="c1"># build url</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.update"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update a TI object in the API.</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type (str): The TI type (e.g., groups or indicators).</span>
<span class="sd">            sub_type (str): The TI sub type (e.g., adversaries or addresses).</span>
<span class="sd">            unique_id (str): The unique ID of the TI object.</span>
<span class="sd">            data (dict): The body for the POST.</span>
<span class="sd">            owner (str): The name of the TC owner.</span>

<span class="sd">        Returns:</span>
<span class="sd">            request.Response: The response from the API call.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">unique_id</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.upload"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.upload">[docs]</a>    <span class="k">def</span> <span class="nf">upload</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">update_if_exists</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Upload a file to API.</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type ([type]): [description]</span>
<span class="sd">            sub_type ([type]): [description]</span>
<span class="sd">            unique_id ([type]): [description]</span>
<span class="sd">            data ([type]): [description]</span>
<span class="sd">            update_if_exists (bool, optional): [description]. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            [type]: [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">update_if_exists</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;updateIfExists&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/upload&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.victim_add_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.victim_add_asset">[docs]</a>    <span class="k">def</span> <span class="nf">victim_add_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_type</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Asset to a Victim.</span>

<span class="sd">        Valid asset_type and optional identifier:</span>
<span class="sd">        + email</span>
<span class="sd">        + network</span>
<span class="sd">        + phone</span>
<span class="sd">        + social</span>
<span class="sd">        + web</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The Victims ID.</span>
<span class="sd">            asset_type: (str) The type of asset to be retrieved.</span>
<span class="sd">            body (dict): The body of the Asset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            request.Response: The response from the API call.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">asset_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">victim_asset_type_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">asset_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">asset_type</span><span class="p">)</span>
        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/victims/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victimAssets/</span><span class="si">{</span><span class="n">asset_type</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_json</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.victim_assets"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.victim_assets">[docs]</a>    <span class="k">def</span> <span class="nf">victim_assets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve the Assets of a Victim.</span>

<span class="sd">        Valid asset_type and optional identifier:</span>
<span class="sd">        + email</span>
<span class="sd">        + network</span>
<span class="sd">        + phone</span>
<span class="sd">        + social</span>
<span class="sd">        + web</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type (str): The main type of the TI object.</span>
<span class="sd">            sub_type (str): The sub type of the TI object.</span>
<span class="sd">            unique_id (str): The unique id of the TI object.</span>
<span class="sd">            asset_type: (str) The type of asset to be retrieved. Defaults to all of them.</span>
<span class="sd">            params (dict, optional): Optional dict of query params.</span>

<span class="sd">        Yields:</span>
<span class="sd">            Json: The asset being retrieved.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="c1"># This is needed because of tasks</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victimAssets&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victimAssets&#39;</span>
        <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;victimAsset&#39;</span>
        <span class="n">asset_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">victim_asset_type_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">asset_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">asset_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;/</span><span class="si">{</span><span class="n">asset_type</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">entity_type</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.victim_get_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.victim_get_asset">[docs]</a>    <span class="k">def</span> <span class="nf">victim_get_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_type</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve a Asset from a Victim.</span>

<span class="sd">        Valid asset_type and optional identifier:</span>
<span class="sd">        + email</span>
<span class="sd">        + network</span>
<span class="sd">        + phone</span>
<span class="sd">        + social</span>
<span class="sd">        + web</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The Victims ID.</span>
<span class="sd">            asset_type: (str) The type of asset to be retrieved.</span>
<span class="sd">            asset_id (str): The Assets ID .</span>
<span class="sd">            params (dict, optional): Optional dict of query params.</span>

<span class="sd">        Returns:</span>
<span class="sd">            request.Response: The response from the API call.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">asset_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">victim_asset_type_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">asset_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">asset_type</span><span class="p">)</span>
        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/victims/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victimAssets/</span><span class="si">{</span><span class="n">asset_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">asset_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">victim_asset_type_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maps the asset type to the api endpoints needed.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;emailAddresses&#39;</span><span class="p">,</span>
            <span class="s1">&#39;network&#39;</span><span class="p">:</span> <span class="s1">&#39;networkAccounts&#39;</span><span class="p">,</span>
            <span class="s1">&#39;phone&#39;</span><span class="p">:</span> <span class="s1">&#39;phoneNumbers&#39;</span><span class="p">,</span>
            <span class="s1">&#39;social&#39;</span><span class="p">:</span> <span class="s1">&#39;socialNetworks&#39;</span><span class="p">,</span>
            <span class="s1">&#39;web&#39;</span><span class="p">:</span> <span class="s1">&#39;webSites&#39;</span><span class="p">,</span>
        <span class="p">}</span>

<div class="viewcode-block" id="TiTcRequest.victim_delete_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.victim_delete_asset">[docs]</a>    <span class="k">def</span> <span class="nf">victim_delete_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_type</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a Asset from a Victim.</span>

<span class="sd">        Valid asset_type and optional identifier:</span>
<span class="sd">        + email</span>
<span class="sd">        + network</span>
<span class="sd">        + phone</span>
<span class="sd">        + social</span>
<span class="sd">        + web</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The Victims ID.</span>
<span class="sd">            asset_type: (str) The type of asset to be retrieved.</span>
<span class="sd">            asset_id (str): The Assets ID .</span>

<span class="sd">        Returns:</span>
<span class="sd">            request.Response: The response from the API call.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">asset_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">victim_asset_type_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">asset_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">asset_type</span><span class="p">)</span>
        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/victims/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victimAssets/</span><span class="si">{</span><span class="n">asset_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">asset_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">asset_url</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.victim_update_asset"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.victim_update_asset">[docs]</a>    <span class="k">def</span> <span class="nf">victim_update_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_type</span><span class="p">,</span> <span class="n">asset_id</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update a Asset of a Victim.</span>

<span class="sd">        Valid asset_type and optional identifier:</span>
<span class="sd">        + email</span>
<span class="sd">        + network</span>
<span class="sd">        + phone</span>
<span class="sd">        + social</span>
<span class="sd">        + web</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The Victims ID.</span>
<span class="sd">            asset_type: (str) The type of asset to be retrieved.</span>
<span class="sd">            asset_id (str): The Assets ID .</span>
<span class="sd">            body (dict): The body of the Asset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            request.Response: The response from the API call.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">asset_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">victim_asset_type_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">asset_type</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">asset_type</span><span class="p">)</span>
        <span class="n">asset_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/victims/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victimAssets/</span><span class="si">{</span><span class="n">asset_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">asset_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_json</span><span class="p">(</span><span class="n">asset_url</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span></div>

    <span class="c1">#</span>
    <span class="c1"># -- needs updates ---</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="TiTcRequest.add_false_positive"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_false_positive">[docs]</a>    <span class="k">def</span> <span class="nf">add_false_positive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="n">owner</span><span class="p">}</span> <span class="k">if</span> <span class="n">owner</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/falsePositive&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{},</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;status code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;url: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest.owners"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.owners">[docs]</a>    <span class="k">def</span> <span class="nf">owners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="n">owner</span><span class="p">}</span> <span class="k">if</span> <span class="n">owner</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/owners&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/owners&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;status code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;url: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest.add_observations"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_observations">[docs]</a>    <span class="k">def</span> <span class="nf">add_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            data:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="n">owner</span><span class="p">}</span> <span class="k">if</span> <span class="n">owner</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/observations&#39;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;status code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;url: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest.observation_count"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.observation_count">[docs]</a>    <span class="k">def</span> <span class="nf">observation_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="n">owner</span><span class="p">}</span> <span class="k">if</span> <span class="n">owner</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/observationCount&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/observationCount&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;status code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;url: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest.observations"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.observations">[docs]</a>    <span class="k">def</span> <span class="nf">observations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            owner:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/observations&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/observations&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;status code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;url: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest.dns_resolution"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.dns_resolution">[docs]</a>    <span class="k">def</span> <span class="nf">dns_resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="n">owner</span><span class="p">}</span> <span class="k">if</span> <span class="n">owner</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/dnsResolution&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/dnsResolution&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;status code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;url: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest.set_dns_resolution"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.set_dns_resolution">[docs]</a>    <span class="k">def</span> <span class="nf">set_dns_resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">         Args:</span>
<span class="sd">             value:</span>
<span class="sd">             owner:</span>
<span class="sd">             main_type:</span>
<span class="sd">             sub_type:</span>
<span class="sd">             unique_id:</span>

<span class="sd">         Return:</span>

<span class="sd">         &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="n">owner</span><span class="p">}</span> <span class="k">if</span> <span class="n">owner</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_true</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_false</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dnsActive&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_true</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">925</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;option&#39;</span><span class="p">,</span> <span class="s1">&#39;dns value&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;status code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;url: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest.set_whois"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.set_whois">[docs]</a>    <span class="k">def</span> <span class="nf">set_whois</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">          Args:</span>
<span class="sd">              value:</span>
<span class="sd">              owner:</span>
<span class="sd">              main_type:</span>
<span class="sd">              sub_type:</span>
<span class="sd">              unique_id:</span>

<span class="sd">          Return:</span>

<span class="sd">          &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="n">owner</span><span class="p">}</span> <span class="k">if</span> <span class="n">owner</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_true</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_false</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;whoisActive&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_true</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">925</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;option&#39;</span><span class="p">,</span> <span class="s1">&#39;whois value&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;status code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;url: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest.is_false"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.is_false">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_false</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;checks to see if a string is False&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="TiTcRequest.is_true"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.is_true">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_true</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;checks to see if a string is True&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="TiTcRequest.deleted"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.deleted">[docs]</a>    <span class="k">def</span> <span class="nf">deleted</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">deleted_since</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            filters:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            deleted_since:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;filters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters_string</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="k">if</span> <span class="n">deleted_since</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;deletedSince&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deleted_since</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/deleted&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/deleted&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="n">r</span><span class="o">.</span><span class="n">reason</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">handle_error</span><span class="p">(</span><span class="mi">950</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">url</span><span class="p">])</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;indicator&#39;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">yield from</span> <span class="n">data</span></div>

<div class="viewcode-block" id="TiTcRequest.pivot_from_tag"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.pivot_from_tag">[docs]</a>    <span class="k">def</span> <span class="nf">pivot_from_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            filters:</span>
<span class="sd">            target:</span>
<span class="sd">            tag_name:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sub_type</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">api_branch</span>
        <span class="n">api_type</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">api_type</span>
        <span class="n">api_entity</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">api_entity</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">if</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;filters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters_string</span>
        <span class="k">if</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/tags/</span><span class="si">{</span><span class="n">tag_name</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">api_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/tags/</span><span class="si">{</span><span class="n">tag_name</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">api_type</span><span class="si">}</span><span class="s1">/&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">api_entity</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.groups_from_tag"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.groups_from_tag">[docs]</a>    <span class="k">def</span> <span class="nf">groups_from_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            group:</span>
<span class="sd">            tag_name:</span>
<span class="sd">            filters:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pivot_from_tag</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.indicators_from_tag"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.indicators_from_tag">[docs]</a>    <span class="k">def</span> <span class="nf">indicators_from_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indicator</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Args:</span>
<span class="sd">                    owner:</span>
<span class="sd">                    indicator:</span>
<span class="sd">                    tag_name:</span>
<span class="sd">                    filters:</span>
<span class="sd">                    params:</span>

<span class="sd">                Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">pivot_from_tag</span><span class="p">(</span>
            <span class="n">indicator</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.victims_from_tag"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.victims_from_tag">[docs]</a>    <span class="k">def</span> <span class="nf">victims_from_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">victim</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            victim:</span>
<span class="sd">            tag_name:</span>
<span class="sd">            filters:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">pivot_from_tag</span><span class="p">(</span>
            <span class="n">victim</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.indicator_associations"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.indicator_associations">[docs]</a>    <span class="k">def</span> <span class="nf">indicator_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/indicators&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/indicators&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;indicator&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.group_associations"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.group_associations">[docs]</a>    <span class="k">def</span> <span class="nf">group_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/groups&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/groups&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;group&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.victim_asset_associations"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.victim_asset_associations">[docs]</a>    <span class="k">def</span> <span class="nf">victim_asset_associations</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">asset_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            asset_type:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victimAssets&#39;</span>
        <span class="k">if</span> <span class="n">asset_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">asset_type</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;victimAsset&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.indicator_associations_types"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.indicator_associations_types">[docs]</a>    <span class="k">def</span> <span class="nf">indicator_associations_types</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">main_type</span><span class="p">,</span>
        <span class="n">sub_type</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">,</span>
        <span class="n">association_type</span><span class="p">,</span>
        <span class="n">api_branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">api_entity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            association_type:</span>
<span class="sd">            api_branch:</span>
<span class="sd">            api_entity:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="n">api_branch</span> <span class="o">=</span> <span class="n">api_branch</span> <span class="ow">or</span> <span class="n">association_type</span><span class="o">.</span><span class="n">api_branch</span>
        <span class="n">api_entity</span> <span class="o">=</span> <span class="n">api_entity</span> <span class="ow">or</span> <span class="n">association_type</span><span class="o">.</span><span class="n">api_entity</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/indicators/</span><span class="si">{</span><span class="n">api_branch</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/indicators/</span><span class="si">{</span><span class="n">api_branch</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">api_entity</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.group_associations_types"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.group_associations_types">[docs]</a>    <span class="k">def</span> <span class="nf">group_associations_types</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">main_type</span><span class="p">,</span>
        <span class="n">sub_type</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">,</span>
        <span class="n">target</span><span class="p">,</span>
        <span class="n">api_branch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">api_entity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Args:</span>
<span class="sd">                    owner:</span>
<span class="sd">                    main_type:</span>
<span class="sd">                    sub_type:</span>
<span class="sd">                    unique_id:</span>
<span class="sd">                    target:</span>
<span class="sd">                    api_branch:</span>
<span class="sd">                    api_entity:</span>
<span class="sd">                    params:</span>

<span class="sd">                Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="n">api_branch</span> <span class="o">=</span> <span class="n">api_branch</span> <span class="ow">or</span> <span class="n">target</span><span class="o">.</span><span class="n">api_branch</span>
        <span class="n">api_entity</span> <span class="o">=</span> <span class="n">api_entity</span> <span class="ow">or</span> <span class="n">target</span><span class="o">.</span><span class="n">api_entity</span>

        <span class="k">if</span> <span class="n">target</span> <span class="ow">and</span> <span class="n">target</span><span class="o">.</span><span class="n">is_task</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/tasks/</span><span class="si">{</span><span class="n">api_branch</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/tasks&#39;</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/groups/</span><span class="si">{</span><span class="n">api_branch</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/groups/</span><span class="si">{</span><span class="n">api_branch</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">api_entity</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.add_association"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_association">[docs]</a>    <span class="k">def</span> <span class="nf">add_association</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">main_type</span><span class="p">,</span>
        <span class="n">sub_type</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">,</span>
        <span class="n">target_type</span><span class="p">,</span>
        <span class="n">target_sub_type</span><span class="p">,</span>
        <span class="n">target_unique_id</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            target_type:</span>
<span class="sd">            target_sub_type:</span>
<span class="sd">            target_unique_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_association</span><span class="p">(</span>
            <span class="n">main_type</span><span class="p">,</span>
            <span class="n">sub_type</span><span class="p">,</span>
            <span class="n">unique_id</span><span class="p">,</span>
            <span class="n">target_type</span><span class="p">,</span>
            <span class="n">target_sub_type</span><span class="p">,</span>
            <span class="n">target_unique_id</span><span class="p">,</span>
            <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_association"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_association">[docs]</a>    <span class="k">def</span> <span class="nf">delete_association</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">main_type</span><span class="p">,</span>
        <span class="n">sub_type</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">,</span>
        <span class="n">target_type</span><span class="p">,</span>
        <span class="n">target_sub_type</span><span class="p">,</span>
        <span class="n">target_unique_id</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            target_type:</span>
<span class="sd">            target_sub_type:</span>
<span class="sd">            target_unique_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_association</span><span class="p">(</span>
            <span class="n">main_type</span><span class="p">,</span>
            <span class="n">sub_type</span><span class="p">,</span>
            <span class="n">unique_id</span><span class="p">,</span>
            <span class="n">target_type</span><span class="p">,</span>
            <span class="n">target_sub_type</span><span class="p">,</span>
            <span class="n">target_unique_id</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">,</span>
            <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest._association"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest._association">[docs]</a>    <span class="k">def</span> <span class="nf">_association</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">main_type</span><span class="p">,</span>
        <span class="n">sub_type</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">,</span>
        <span class="n">target_type</span><span class="p">,</span>
        <span class="n">target_sub_type</span><span class="p">,</span>
        <span class="n">target_unique_id</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ADD&#39;</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            target_type:</span>
<span class="sd">            target_sub_type:</span>
<span class="sd">            target_unique_id:</span>
<span class="sd">            action:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;owner&#39;</span><span class="p">:</span> <span class="n">owner</span><span class="p">}</span> <span class="k">if</span> <span class="n">owner</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Typically if victim to victim but other endpoints that are not</span>
        <span class="c1"># groups/indicators can exist in the future</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">target_sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target_unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="c1"># Typically if victim to anything else</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target_sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target_unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="c1"># If anything else to victim</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">target_sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target_unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Everything else</span>
            <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target_sub_type</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="sa">f</span><span class="s1">&#39;/</span><span class="si">{</span><span class="n">target_unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>

        <span class="n">r</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;ADD&#39;</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{},</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;associations error&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;status code: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;url: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span></div>

<div class="viewcode-block" id="TiTcRequest.victim"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.victim">[docs]</a>    <span class="k">def</span> <span class="nf">victim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">victim_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            victim_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;createActivityLog&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victims/</span><span class="si">{</span><span class="n">victim_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victims/</span><span class="si">{</span><span class="n">victim_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.victims"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.victims">[docs]</a>    <span class="k">def</span> <span class="nf">victims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victims&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/victims&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;victim&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.file_occurrences"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.file_occurrences">[docs]</a>    <span class="k">def</span> <span class="nf">file_occurrences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Yields all occurrences a File has</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            owner:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/fileOccurrences&#39;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;fileOccurrence&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.get_file_hash"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_file_hash">[docs]</a>    <span class="k">def</span> <span class="nf">get_file_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">hash_type</span><span class="o">=</span><span class="s1">&#39;sha256&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Gets the hash of a file. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/download&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/download&#39;</span>

        <span class="k">if</span> <span class="n">hash_type</span> <span class="o">==</span> <span class="s1">&#39;sha256&#39;</span><span class="p">:</span>
            <span class="n">hashed_file</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">()</span>  <span class="c1"># nosec</span>
        <span class="k">elif</span> <span class="n">hash_type</span> <span class="o">==</span> <span class="s1">&#39;sha1&#39;</span><span class="p">:</span>
            <span class="n">hashed_file</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">()</span>  <span class="c1"># nosec</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hashed_file</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>  <span class="c1"># nosec</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">4096</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">chunk</span><span class="p">:</span>  <span class="c1"># filter out keep-alive new chunks</span>
                    <span class="n">hashed_file</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">hashed_file</span></div>

<div class="viewcode-block" id="TiTcRequest.get_file_occurrence"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_file_occurrence">[docs]</a>    <span class="k">def</span> <span class="nf">get_file_occurrence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">occurrence_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets a file occurrence given a occurrence_id</span>
<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            occurrence_id:</span>
<span class="sd">            owner:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_occurrence</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">occurrence_id</span><span class="p">,</span> <span class="n">owner</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_file_action"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_file_action">[docs]</a>    <span class="k">def</span> <span class="nf">delete_file_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes a file action given a target&quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/actions/</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="sa">f</span><span class="s1">&#39;/</span><span class="si">{</span><span class="n">target</span><span class="o">.</span><span class="n">api_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target</span><span class="o">.</span><span class="n">api_branch</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target</span><span class="o">.</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.add_file_action"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_file_action">[docs]</a>    <span class="k">def</span> <span class="nf">add_file_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a file action given a target&quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/actions/</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="sa">f</span><span class="s1">&#39;/</span><span class="si">{</span><span class="n">target</span><span class="o">.</span><span class="n">api_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target</span><span class="o">.</span><span class="n">api_branch</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target</span><span class="o">.</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{},</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.get_file_actions"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_file_actions">[docs]</a>    <span class="k">def</span> <span class="nf">get_file_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Yields a file action given a file action and a target&quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/actions/</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target</span><span class="o">.</span><span class="n">api_type</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">api_sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">target</span><span class="o">.</span><span class="n">api_branch</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">target</span><span class="o">.</span><span class="n">api_entity</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_file_occurrence"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_file_occurrence">[docs]</a>    <span class="k">def</span> <span class="nf">delete_file_occurrence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">occurrence_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes a file occurrence given a occurrence_id</span>
<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            occurrence_id:</span>
<span class="sd">            owner:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_occurrence</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">occurrence_id</span><span class="p">,</span> <span class="n">owner</span><span class="p">,</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.file_occurrence"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.file_occurrence">[docs]</a>    <span class="k">def</span> <span class="nf">file_occurrence</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">occurrence_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets a file occurrence given a occurrence_id</span>
<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            occurrence_id:</span>
<span class="sd">            owner:</span>
<span class="sd">            action:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/fileOccurrences/</span><span class="si">{</span><span class="n">occurrence_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="TiTcRequest.add_file_occurrence"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_file_occurrence">[docs]</a>    <span class="k">def</span> <span class="nf">add_file_occurrence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a file occurrence to a File</span>
<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            name:</span>
<span class="sd">            date:</span>
<span class="sd">            path:</span>
<span class="sd">            owner:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/fileOccurrences&#39;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fileName&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">path</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">})</span></div>

<div class="viewcode-block" id="TiTcRequest.tag"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.tag">[docs]</a>    <span class="k">def</span> <span class="nf">tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            tag:</span>
<span class="sd">            action:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/tags/</span><span class="si">{</span><span class="n">quote</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/tags/</span><span class="si">{</span><span class="n">quote</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;ADD&#39;</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{},</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tcex</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;_tags error&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span></div>

<div class="viewcode-block" id="TiTcRequest.add_tag"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_tag">[docs]</a>    <span class="k">def</span> <span class="nf">add_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            tag:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ADD&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_tag"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_tag">[docs]</a>    <span class="k">def</span> <span class="nf">delete_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            tag:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.get_tag"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_tag">[docs]</a>    <span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            tag:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.tags"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.tags">[docs]</a>    <span class="k">def</span> <span class="nf">tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            owner:</span>
<span class="sd">            filters:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="k">if</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;filters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters_string</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/tags&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/tags&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.labels"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.labels">[docs]</a>    <span class="k">def</span> <span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            owner:</span>
<span class="sd">            filters:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="k">if</span> <span class="n">filters</span> <span class="ow">and</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;filters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">filters_string</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/securityLabels&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/securityLabels&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;securityLabel&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.add_label"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            label:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ADD&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.get_label"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_label">[docs]</a>    <span class="k">def</span> <span class="nf">get_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            label:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">(</span>
            <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_label"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_label">[docs]</a>    <span class="k">def</span> <span class="nf">delete_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            label:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.label"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.label">[docs]</a>    <span class="k">def</span> <span class="nf">label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ADD&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            label:</span>
<span class="sd">            action:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/securityLabels/</span><span class="si">{</span><span class="n">quote</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/securityLabels/</span><span class="si">{</span><span class="n">quote</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;ADD&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{},</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="TiTcRequest.attributes"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.attributes">[docs]</a>    <span class="k">def</span> <span class="nf">attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;attribute&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.attribute"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.attribute">[docs]</a>    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            attribute_id:</span>
<span class="sd">            action:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes/</span><span class="si">{</span><span class="n">attribute_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes/</span><span class="si">{</span><span class="n">attribute_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="TiTcRequest.get_attribute"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            attribute_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span>
            <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_attribute"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">delete_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            attribute_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="p">(</span>
            <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.add_attribute"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">add_attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">main_type</span><span class="p">,</span>
        <span class="n">sub_type</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">,</span>
        <span class="n">attribute_type</span><span class="p">,</span>
        <span class="n">attribute_value</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">displayed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            displayed:</span>
<span class="sd">            source:</span>
<span class="sd">            params:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            attribute_type:</span>
<span class="sd">            attribute_value:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes&#39;</span>

        <span class="n">json</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">attribute_type</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">attribute_value</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">source</span><span class="p">:</span>
            <span class="n">json</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span>

        <span class="k">if</span> <span class="n">displayed</span><span class="p">:</span>
            <span class="n">json</span><span class="p">[</span><span class="s1">&#39;displayed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">displayed</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.update_attribute"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.update_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">update_attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">main_type</span><span class="p">,</span>
        <span class="n">sub_type</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">,</span>
        <span class="n">attribute_value</span><span class="p">,</span>
        <span class="n">attribute_id</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">displayed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            displayed:</span>
<span class="sd">            source:</span>
<span class="sd">            params:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            attribute_type:</span>
<span class="sd">            attribute_value:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes/</span><span class="si">{</span><span class="n">attribute_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes/</span><span class="si">{</span><span class="n">attribute_id</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="n">json</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">attribute_value</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">source</span><span class="p">:</span>
            <span class="n">json</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span>

        <span class="k">if</span> <span class="n">displayed</span><span class="p">:</span>
            <span class="n">json</span><span class="p">[</span><span class="s1">&#39;displayed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">displayed</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_put_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.attribute_labels"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.attribute_labels">[docs]</a>    <span class="k">def</span> <span class="nf">attribute_labels</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            attribute_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes/</span><span class="si">{</span><span class="n">attribute_id</span><span class="si">}</span><span class="s1">/securityLabels&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes/</span><span class="si">{</span><span class="n">attribute_id</span><span class="si">}</span><span class="s1">/securityLabels&#39;</span>

        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;securityLabel&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.attribute_label"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.attribute_label">[docs]</a>    <span class="k">def</span> <span class="nf">attribute_label</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">main_type</span><span class="p">,</span>
        <span class="n">sub_type</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">,</span>
        <span class="n">attribute_id</span><span class="p">,</span>
        <span class="n">label</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            attribute_id:</span>
<span class="sd">            label:</span>
<span class="sd">            action:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">owner</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;owner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_type</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes/</span><span class="si">{</span><span class="n">attribute_id</span><span class="si">}</span><span class="s1">/securityLabels/&#39;</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">quote</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">sub_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/attributes/</span><span class="si">{</span><span class="n">attribute_id</span><span class="si">}</span><span class="s1">/securityLabels/&#39;</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">quote</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;ADD&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{},</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="TiTcRequest.get_attribute_label"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_attribute_label">[docs]</a>    <span class="k">def</span> <span class="nf">get_attribute_label</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            attribute_id:</span>
<span class="sd">            label:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute_label</span><span class="p">(</span>
            <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_attribute_label"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_attribute_label">[docs]</a>    <span class="k">def</span> <span class="nf">delete_attribute_label</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            attribute_id:</span>
<span class="sd">            label:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute_label</span><span class="p">(</span>
            <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.add_attribute_label"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_attribute_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_attribute_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            owner:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            attribute_id:</span>
<span class="sd">            label:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute_label</span><span class="p">(</span>
            <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">attribute_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ADD&#39;</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.assignees"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.assignees">[docs]</a>    <span class="k">def</span> <span class="nf">assignees</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/assignees&#39;</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.assignee"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.assignee">[docs]</a>    <span class="k">def</span> <span class="nf">assignee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">assignee_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ADD&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            assignee_id:</span>
<span class="sd">            action:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/assignees/</span><span class="si">{</span><span class="n">assignee_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;ADD&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{},</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="TiTcRequest.get_assignee"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_assignee">[docs]</a>    <span class="k">def</span> <span class="nf">get_assignee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">assignee_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            assignee_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignee</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">assignee_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_assignee"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_assignee">[docs]</a>    <span class="k">def</span> <span class="nf">delete_assignee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">assignee_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            assignee_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignee</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">assignee_id</span><span class="p">,</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.add_assignee"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_assignee">[docs]</a>    <span class="k">def</span> <span class="nf">add_assignee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">assignee_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            assignee_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignee</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">assignee_id</span><span class="p">,</span> <span class="s1">&#39;ADD&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.escalatees"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.escalatees">[docs]</a>    <span class="k">def</span> <span class="nf">escalatees</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/escalatees&#39;</span>
        <span class="k">yield from</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iterate</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.escalatee"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.escalatee">[docs]</a>    <span class="k">def</span> <span class="nf">escalatee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">escalatee_id</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            escalatee_id:</span>
<span class="sd">            action:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/v2/</span><span class="si">{</span><span class="n">main_type</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s1">/escalatees/</span><span class="si">{</span><span class="n">escalatee_id</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;ADD&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{},</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="TiTcRequest.get_escalatee"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.get_escalatee">[docs]</a>    <span class="k">def</span> <span class="nf">get_escalatee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">escalatee_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            escalatee_id:</span>
<span class="sd">            params:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">escalatee</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">escalatee_id</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.delete_escalatee"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.delete_escalatee">[docs]</a>    <span class="k">def</span> <span class="nf">delete_escalatee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">escalatee_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            escalatee_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">escalatee</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">escalatee_id</span><span class="p">,</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.add_escalatee"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.add_escalatee">[docs]</a>    <span class="k">def</span> <span class="nf">add_escalatee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">escalatee_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            main_type:</span>
<span class="sd">            sub_type:</span>
<span class="sd">            unique_id:</span>
<span class="sd">            escalatee_id:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">escalatee</span><span class="p">(</span><span class="n">main_type</span><span class="p">,</span> <span class="n">sub_type</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">escalatee_id</span><span class="p">,</span> <span class="s1">&#39;ADD&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TiTcRequest.success"><a class="viewcode-back" href="../../../tcex_docs/tcex.threat_intelligence.html#tcex.threat_intelligence.tcex_ti_tc_request.TiTcRequest.success">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">success</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            r:</span>

<span class="sd">        Return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;Success&#39;</span><span class="p">:</span>
                    <span class="n">status</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">status</span></div></div>
</pre></div>

           </div>

          </div>
          <footer>


  <hr/>

  <div role="contentinfo">
    <p>

        &copy; Copyright 2016, ThreatConnect Inc

    </p>
  </div>

</footer>

        </div>
      </div>

    </section>

  </div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>






</body>
</html>
